function sha1(t){var i,e,a,n,o,s,l,r,c,u=function(t,i){var e=t<<i|t>>>32-i;return e},d=function(t){var i,e,a="";for(i=7;i>=0;i--)e=t>>>4*i&15,a+=e.toString(16);return a},h=new Array(80),p=1732584193,f=4023233417,y=2562383102,v=271733878,m=3285377520;t=unescape(encodeURIComponent(t));var g=t.length,w=[];for(e=0;g-3>e;e+=4)a=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),w.push(a);switch(g%4){case 0:e=2147483648;break;case 1:e=t.charCodeAt(g-1)<<24|8388608;break;case 2:e=t.charCodeAt(g-2)<<24|t.charCodeAt(g-1)<<16|32768;break;case 3:e=t.charCodeAt(g-3)<<24|t.charCodeAt(g-2)<<16|t.charCodeAt(g-1)<<8|128}for(w.push(e);w.length%16!=14;)w.push(0);for(w.push(g>>>29),w.push(g<<3&4294967295),i=0;i<w.length;i+=16){for(e=0;16>e;e++)h[e]=w[i+e];for(e=16;79>=e;e++)h[e]=u(h[e-3]^h[e-8]^h[e-14]^h[e-16],1);for(n=p,o=f,s=y,l=v,r=m,e=0;19>=e;e++)c=u(n,5)+(o&s|~o&l)+r+h[e]+1518500249&4294967295,r=l,l=s,s=u(o,30),o=n,n=c;for(e=20;39>=e;e++)c=u(n,5)+(o^s^l)+r+h[e]+1859775393&4294967295,r=l,l=s,s=u(o,30),o=n,n=c;for(e=40;59>=e;e++)c=u(n,5)+(o&s|o&l|s&l)+r+h[e]+2400959708&4294967295,r=l,l=s,s=u(o,30),o=n,n=c;for(e=60;79>=e;e++)c=u(n,5)+(o^s^l)+r+h[e]+3395469782&4294967295,r=l,l=s,s=u(o,30),o=n,n=c;p=p+n&4294967295,f=f+o&4294967295,y=y+s&4294967295,v=v+l&4294967295,m=m+r&4294967295}return c=d(p)+d(f)+d(y)+d(v)+d(m),c.toLowerCase()}function slugify(t){return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}function Item(t,i){this.title=i,this.id=t}function youtube_parser(t){var i=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,e=t.match(i);return e&&11==e[7].length?e[7]:null}function onYouTubeIframeAPIReady(){application.player=new YT.Player("player-container",{height:"390",width:"640",video:null,playerVars:{wmode:"opaque"},events:{onReady:function(){application.playNextVideoInQueue(),application.playerLoaded=!0},onStateChange:function(t){t.data==YT.PlayerState.ENDED&&application.queue.length>0&&application.playNextVideoInQueue()}}})}function shuffle(t){for(var i,e,a=t.length;0!==a;)e=Math.floor(Math.random()*a),a-=1,i=t[a],t[a]=t[e],t[e]=i;return t}eval(function(t,i,e,a,n,o){if(n=function(t){return(i>t?"":n(parseInt(t/i)))+((t%=i)>35?String.fromCharCode(t+29):t.toString(36))},!"".replace(/^/,String)){for(;e--;)o[n(e)]=a[e]||n(e);a=[function(t){return o[t]}],n=function(){return"\\w+"},e=1}for(;e--;)a[e]&&(t=t.replace(new RegExp("\\b"+n(e)+"\\b","g"),a[e]));return t}(";5 V=(8(){\"1D 1B\";5 j={l:'l',E:'1y',m:'m',p:'1x',q:'1v',v:'v'},19={\"1u\":1t,\"1q\":1n,\"1m\":11,\"1k\":18,\"1j\":11,\"1i\":18},S=8(a,b){5 d=1g,O=d.1f('a'),b=b||d.17.G,H=b.r(/\\/\\/(.*?)(?::(.*?))?@/)||[];O.G=b;w(5 i R j){a[i]=O[j[i]]||''}a.l=a.l.o(/:$/,'');a.q=a.q.o(/^\\?/,'');a.v=a.v.o(/^#/,'');a.F=H[1]||'';a.x=H[2]||'';a.m=(19[a.l]==a.m||a.m==0)?'':a.m;9(!a.l&&!/^([a-z]+:)?\\/\\//.1d(b)){5 c=T V(d.17.G.r(/(.*\\/)/)[0]),A=c.p.X('/'),B=a.p.X('/');A.W();w(5 i=0,C=['l','F','x','E','m'],s=C.Z;i<s;i++){a[C[i]]=c[C[i]]}10(B[0]=='..'){A.W();B.1c()}a.p=(b.1p(0,1)!='/'?A.13('/'):'')+'/'+B.13('/')}D{a.p=a.p.o(/^\\/?/,'/')}14(a)},15=8(s){s=s.o(/\\+/g,' ');s=s.o(/%([1b][0-t-f])%([P][0-t-f])%([P][0-t-f])/N,8(a,b,c,d){5 e=u(b,16)-1e,Q=u(c,16)-M;9(e==0&&Q<1h){k a}5 f=u(d,16)-M,n=(e<<12)+(Q<<6)+f;9(n>1l){k a}k K.J(n)});s=s.o(/%([1o][0-t-f])%([P][0-t-f])/N,8(a,b,c){5 d=u(b,16)-1a;9(d<2){k a}5 e=u(c,16)-M;k K.J((d<<6)+e)});s=s.o(/%([0-7][0-t-f])/N,8(a,b){k K.J(u(b,16))});k s},14=8(g){5 h=g.q;g.q=T(8(c){5 d=/([^=&]+)(=([^&]*))?/g,r;10((r=d.1r(c))){5 f=1s(r[1].o(/\\+/g,' ')),I=r[3]?15(r[3]):'';9(4[f]!=1w){9(!(4[f]y Y)){4[f]=[4[f]]}4[f].1z(I)}D{4[f]=I}}4.1A=8(){w(f R 4){9(!(4[f]y U)){1C 4[f]}}};4.L=8(){5 s='',e=1E;w(5 i R 4){9(4[i]y U){1F}9(4[i]y Y){5 a=4[i].Z;9(a){w(5 b=0;b<a;b++){s+=s?'&':'';s+=e(i)+'='+e(4[i][b])}}D{s+=(s?'&':'')+e(i)+'='}}D{s+=s?'&':'';s+=e(i)+'='+e(4[i])}}k s}})(h)};k 8(a){4.L=8(){k((4.l&&(4.l+'://'))+(4.F&&(4.F+(4.x&&(':'+4.x))+'@'))+(4.E&&4.E)+(4.m&&(':'+4.m))+(4.p&&4.p)+(4.q.L()&&('?'+4.q))+(4.v&&('#'+4.v)))};S(4,a)}}());",62,104,"||||this|var|||function|if|||||||||||return|protocol|port||replace|path|query|match||9a|parseInt|hash|for|pass|instanceof||basePath|selfPath|props|else|host|user|href|auth|value|fromCharCode|String|toString|0x80|gi|link|89ab|n2|in|parse|new|Function|Url|pop|split|Array|length|while|80||join|parseQs|decode||location|443|defaultPorts|0xC0|ef|shift|test|0xE0|createElement|document|32|wss|ws|https|0xFFFF|http|70|cd|substring|gopher|exec|decodeURIComponent|21|ftp|search|null|pathname|hostname|push|clear|strict|delete|use|encodeURIComponent|continue".split("|"),0,{})),application={con:null,url:null,playlistid:null,player:null,routes:null,current:null,currentIndex:-1,playerLoaded:!1,queue:[],base:"https://yt-playlist.firebaseio.com/",init:function(){this.loadPartials(),this.setupRoutes(),this.setupEvents(),$.ajaxSetup({cache:!1});var t=this;if(this.url=new Url,"onhashchange"in window)window.onhashchange=function(){t.hashChanged(window.location.hash)};else{var i=window.location.hash;window.setInterval(function(){window.location.hash!=i&&(i=window.location.hash,t.hashChanged(i))},100)}},loadPartials:function(){$("div.partial").each(function(){var t=$(this),i=t.attr("data-partial");$.get("partials/"+i,function(i,e,a){t.html(i)})})},setupRoutes:function(){function t(t,i){this.regex=t,this.action=i,this.check=function(t){return t.match(this.regex)}}this.routes={init:function(){this.array.push(new t(/#join/,"joinAction")),this.array.push(new t(/#new/,"newAction")),this.array.push(new t(/#playlist-([\w+-]*)/,"playlistAction"))},array:[]},this.routes.init()},setupEvents:function(){var t=this;$("#new-playlist-trigger").on("click.ytplaylist",function(){t.newAction()}),$("#new-playlist-id").keypress(function(i){13==i.keyCode&&t.newAction()}),$("#join-id").keypress(function(t){13==t.keyCode&&(window.location="#playlist-"+$(this).val())}),$("#join-trigger").on("click.ytplaylist",function(t){window.location="#playlist-"+$("#join-id").val()})},setupSearch:function(){function t(){$("#search-results").html("")}function i(t){return"//img.youtube.com/vi/"+t+"/default.jpg"}function e(t){var e=t.id.videoId,a=t.snippet.title,n=i(e),o='<li class="result-item" data-id="'+e+'"><div class="col-xs-4 search-result-image"><img src="'+n+'"></div></div><div class="col-xs-8 search-result-title">'+a+"</div></li>";$("#search-results").append(o)}var a=this,n=$("#search");$("#clear-results").on("click",function(){t()}),n.keyup(function(){var i=$(this).val();if(i.length<3)return void t();if(!i||""==i)return void t();var n=encodeURIComponent(i),o="https://www.googleapis.com/youtube/v3/search?q="+n+"&format=5&max-results=10&v=2&alt=json";o+="&key=AIzaSyC1Z8X72HT-NJeqHnYA2hyNrUqK7eM7REw&part=snippet",$.ajax({type:"GET",url:o,dataType:"jsonp",success:function(i){t(),i.items?$.each(i.items,function(t,i){for(var n=i.id.videoId,o=0;o<a.queue.length;o++)if(n==a.queue[o].id)return;e(i)}):$("#search-results").append("<li>No results</li>")}})}),$("body").on("click",".result-item:not(.item-added)",function(){$(this).addClass("item-added");var t=$(this).attr("data-id"),i=$(this).find(".search-result-title").text();t&&a.addToQueue(t,i)}),$("#shuffle").on("click",function(t){var i=t.target;$("#"+i.id+" i").addClass("fa-spin"),a.queue=shuffle(a.queue),a.createPlaylistView(),a.playFirstVideoInQueue(),setTimeout(function(){$("#"+i.id+" i").removeClass("fa-spin")},5e3)})},hashChanged:function(t){for(var i=this.routes,e=0;e<i.array.length;e++){var a=i.array[e],n=a.check(t);if(n){var o=a.action;"function"==typeof this[o]&&this[o](n)}}},connect:function(t){return t=t||"",this.con=new Firebase(this.base+t),this.con},checkIfPlaylistExists:function(t,i){var e=this.connect("");e.child(t).once("value",function(t){i(null!==t.val())})},createPlaylist:function(t){this.playlistid=t,this.getPlaylistConn().push({data:"create"})},newAction:function(){var t=this,i=$("#new-playlist-id").val();return i&&""!=i?(this.hideNotify(),i=slugify(i),void this.checkIfPlaylistExists(i,function(e){e?t.notify("Name is taken!","danger"):(t.createPlaylist(i),window.location="#playlist-"+i)})):void this.notify("Enter wanted playlist name","danger")},playlistAction:function(t){var i=t[1],e=this;this.checkIfPlaylistExists(i,function(t){t?e.loadPlaylist(i):e.notify("Playlist doesn't exists","danger")})},loadPlaylist:function(t){"undefined"!=typeof Storage&&localStorage.setItem("ytplaylist.lastPlaylistId",t);var i=this;this.loadPage("playlist.html",function(){i.loadPartials(),i.setupSearch(),$("#playlist-id").html(t),i.playlistid=t,i.getPlaylistConn().on("child_added",i.handleChildAdded);var e=document.createElement("script");e.src="//www.youtube.com/iframe_api?enablejsapi=1";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(e,a)})},handleChildAdded:function(t){var i=t.val();i.hasOwnProperty("id")&&i.hasOwnProperty("action")&&(i.action==application.actions.add&&i.hasOwnProperty("title")?application.addVideoToPlaylist(i.id,i.title):i.action==application.actions.remove?application.removeVideoFromPlaylist(i.id):i.action==application.actions.moveDown?application.moveVideoDownInPlaylist(i.id):i.action==application.actions.moveUp&&application.moveVideoUpInPlaylist(i.id))},createPlaylistView:function(){var t=$("#playlist"),i=this;t.html("");for(var e=0;e<this.queue.length;e++){var a=this.queue[e].id,n=$("<div/>").addClass("actions").append('<div class="remove-item" data-id="'+a+'"><i class="fa fa-trash"></i></div>').append('<div class="up-item" data-id="'+a+'"><i class="fa fa-arrow-up"></i></div>').append('<div class="down-item" data-id="'+a+'"><i class="fa fa-arrow-down"></i></div>'),o=$("<div/>").addClass("item-title").addClass("col-xs-8").text(this.queue[e].title);$("<li/>").addClass("playlist-item").attr({"data-id":a}).html('<div class="col-xs-4"><img src="//img.youtube.com/vi/'+a+'/default.jpg"></div>').append(n).append(o).appendTo(t)}$("body").off("click.ytplaylist"),$("body").on("click.ytplaylist",".playlist-item:not(.current)",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).attr("data-id");i.playVideoByCode(e)}),$("body").on("click.ytplaylist",".playlist-item .remove-item",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).attr("data-id");confirm("Are you sure?")&&i.removeFromQueue(e)}),$("body").on("click.ytplaylist",".playlist-item .up-item",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).attr("data-id");i.moveUp(e)}),$("body").on("click.ytplaylist",".playlist-item .down-item",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).attr("data-id");i.moveDown(e)})},addVideoToPlaylist:function(t,i){var e=new Item(t,i);this.queue.push(e),this.createPlaylistView()},getPlaylistConn:function(){return this.con.child(this.playlistid)},addToQueue:function(t,i){this.getPlaylistConn().push({id:t,title:i,action:this.actions.add})},removeFromQueue:function(t){this.getPlaylistConn().push({id:t,action:this.actions.remove})},moveUp:function(t){this.getPlaylistConn().push({id:t,action:this.actions.moveUp})},moveDown:function(t){this.getPlaylistConn().push({id:t,action:this.actions.moveDown})},actions:{add:1,remove:2,moveUp:3,moveDown:4},random:function(){return Math.random().toString(36).substr(2,9)},joinAction:function(){var t=$("#join-id").val(),i=this;t?(this.playlistid=t,this.connect(),this.getPlaylistConn().once("value",function(e){var a=null!==e.val();a?i.loadPlaylist(t):(i.redirect(""),i.notify("playlist not found","danger"))})):(this.notify("No playlist ID specified","danger"),this.redirect(""))},redirect:function(t){window.location.hash=t},hideNotify:function(){$("#notification").hide().html("")},notify:function(t,i){this.hideNotify(),$("#notification").html('<div class="alert alert-'+i+'">'+t+"</div>"),$("#notification").fadeIn()},loadPage:function(t,i){this.hideNotify(),$.ajax({url:t,dataType:"HTML"}).done(function(t){$("#main").html(""),$("#main").append(t),i&&i()})},isPlaying:function(){if(!this.player||"function"!=typeof this.player.getPlayerState)return!1;var t=this.player.getPlayerState();return t==YT.PlayerState.PLAYING},getIndexOf:function(t){for(var i=0;i<this.queue.length;i++)if(this.queue[i].id==t)return i},switchPlaces:function(t,i){var e=this.queue[t];this.queue[t]=this.queue[i],this.queue[i]=e},moveVideoUpInPlaylist:function(t){var i=this.getIndexOf(t);i<this.queue.length&&i>=1&&this.switchPlaces(i,i-1),this.createPlaylistView()},moveVideoDownInPlaylist:function(t){var i=this.getIndexOf(t);i>=0&&i<this.queue.length-1&&this.switchPlaces(i,i+1),this.createPlaylistView()},removeVideoFromPlaylist:function(t){var i=this.getIndexOf(t);i>-1&&this.queue.splice(i,1),this.createPlaylistView()},playVideoByCode:function(t){this.isPlaying()&&this.player.stopVideo(),this.player.loadVideoById(t),this.player.playVideo(),$(".playlist-item.current").removeClass("current");var i=$('.playlist-item[data-id="'+t+'"] .item-title').text();$("#song-name").text(i);var e=$('.playlist-item[data-id="'+t+'"]');e.addClass("current"),$("#playlist-container").animate({scrollTop:$("#playlist-container").scrollTop()+e.offset().top},{duration:"medium",easing:"swing"}),this.current=t,this.currentIndex=this.getIndexOf(this.current)},playNextVideoInQueue:function(){if(this.queue.length>0){var t=this.currentIndex+1;this.queue.length==t&&(t=0);var i=this.queue[t];this.playVideoByCode(i.id)}},playFirstVideoInQueue:function(){if(this.queue.length>0){var t=this.queue[0];this.playVideoByCode(t.id)}}},$(function(){application.init();var t=localStorage.getItem("ytplaylist.lastPlaylistId");t&&$("#last-playlist-id").html('<a href="#playlist-'+t+'">'+t+"</a>"),application.hashChanged(window.location.hash)}),$(window).bind("load",function(){var t=$(".footer"),i=t.position(),e=$(window).height();e-=i.top,e-=t.height(),e>0&&t.css({"margin-top":e+"px",bottom:"10px"})});